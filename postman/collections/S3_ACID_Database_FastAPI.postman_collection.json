{
  "info": {
    "name": "S3 ACID Database - FastAPI",
    "description": "FastAPI collection for S3 ACID Database - cleaner than Lambda format\n\nEnvironment Variables:\n- baseUrl: API base URL (e.g., http://localhost:9000)\n- tenant_id: Tenant identifier\n- namespace: Table namespace",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/health",
          "host": ["{{baseUrl}}"],
          "path": ["health"]
        },
        "description": "Check if the FastAPI server is healthy"
      }
    },
    {
      "name": "1. CREATE TABLE - users",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"CREATE_TABLE\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\",\n  \"schema\": {\n    \"fields\": {\n      \"name\": {\"type\": \"string\", \"required\": true},\n      \"email\": {\"type\": \"string\", \"required\": true},\n      \"age\": {\"type\": \"integer\", \"required\": false}\n    }\n  },\n  \"if_not_exists\": true\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Create Iceberg table with schema using PyIceberg"
      }
    },
    {
      "name": "2. WRITE - Insert users",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"WRITE\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\",\n  \"records\": [\n    {\"name\": \"Alice\", \"email\": \"alice@example.com\", \"age\": 30},\n    {\"name\": \"Bob\", \"email\": \"bob@example.com\", \"age\": 25},\n    {\"name\": \"Charlie\", \"email\": \"charlie@example.com\", \"age\": 35}\n  ]\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Write records to Iceberg table using PyIceberg"
      }
    },
    {
      "name": "3. QUERY - Get all users",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"QUERY\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\",\n  \"limit\": 100\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Query all users using DuckDB iceberg_scan"
      }
    },
    {
      "name": "4. QUERY - Filter by name",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"QUERY\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\",\n  \"filter\": {\"name\": {\"eq\": \"Alice\"}},\n  \"limit\": 10\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Query users with filter - name equals Alice"
      }
    },
    {
      "name": "5. QUERY - Filter by age greater than",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"QUERY\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\",\n  \"filter\": {\"age\": {\"gt\": 28}},\n  \"limit\": 10\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Query users where age > 28"
      }
    },
    {
      "name": "6. QUERY - With sorting",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"QUERY\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\",\n  \"sort\": [{\"field\": \"age\", \"order\": \"desc\"}],\n  \"limit\": 10\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Query users sorted by age descending"
      }
    },
    {
      "name": "7. UPDATE - Update user age",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"UPDATE\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\",\n  \"updates\": {\"age\": 31},\n  \"filter\": {\"name\": {\"eq\": \"Alice\"}}\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Update Alice's age to 31"
      }
    },
    {
      "name": "8. DELETE - Soft delete user",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"DELETE\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\",\n  \"filter\": {\"name\": {\"eq\": \"Charlie\"}}\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Soft delete Charlie (marks _deleted=true)"
      }
    },
    {
      "name": "9. QUERY - Include deleted records",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"QUERY\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\",\n  \"include_deleted\": true,\n  \"limit\": 100\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Query with include_deleted=true to see soft-deleted records"
      }
    },
    {
      "name": "10. HARD_DELETE - Permanent removal",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"HARD_DELETE\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\",\n  \"filter\": {\"name\": {\"eq\": \"Charlie\"}},\n  \"confirm\": true\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Physically remove records from storage (IRREVERSIBLE!)"
      }
    },
    {
      "name": "12. LIST TABLES",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"LIST_TABLES\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "List all tables in namespace"
      }
    },
    {
      "name": "13. DESCRIBE TABLE",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"DESCRIBE_TABLE\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Get table schema and statistics"
      }
    },
    {
      "name": "14. COMPACT - Merge small files",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operation\": \"COMPACT\",\n  \"tenant_id\": \"{{tenant_id}}\",\n  \"namespace\": \"{{namespace}}\",\n  \"table\": \"users\",\n  \"force\": true,\n  \"expire_snapshots\": true,\n  \"snapshot_retention_hours\": 168\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/database",
          "host": ["{{baseUrl}}"],
          "path": ["database"]
        },
        "description": "Compact small files into larger files to improve query performance"
      }
    }
  ]
}
